{% extends 'users/Trainer/trainer_dashboard.html' %}
{% block dashboard_content %}
    <h2>Manage Your Availability</h2>

    {% if availabilities %}
        <table>
            <tr>
                <th>Date</th>
                <th>Start Time</th>
                <th>End Time</th>
                <th>Actions</th>
            </tr>
            {% for a in availabilities %}
            <tr>
                <td>{{ a.date|date:"Y-m-d" }}</td>
                <td>{{ a.start_time }}</td>
                <td>{{ a.end_time }}</td>
                <td>
                    <form method="post">{% csrf_token %}
                        <input type="hidden" name="edit_id" value="{{ a.id }}">
                        <button type="submit" >Edit</button>
                    </form>
                    <form method="post">{% csrf_token %}
                        <input type="hidden" name="delete_id" value="{{ a.id }}">
                        <button type="submit" >Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>No availability added yet.</p>
    {% endif %}

    <hr>
    <h3>{{ action }} Availability</h3>

    <form method="post">
        {% csrf_token %}
        {% if action == "Edit" %}
            <input type="hidden" name="availability_id" value="{{ form.instance.id }}">
        {% endif %}
        <p>
            {{ form.date.label_tag }}
            <input type="date" name="{{ form.date.name }}" id="{{ form.date.id_for_label }}"
                   min="{{ now|date:'Y-m-d' }}"
                   value="{{ form.date.value|default_if_none:'' }}">
        </p>
        <p>
            {{ form.start_time.label_tag }}
            <input type="time" name="{{ form.start_time.name }}" id="{{ form.start_time.id_for_label }}"
                   value="{{ form.start_time.value|default_if_none:'' }}">
        </p>
        <p>
            {{ form.end_time.label_tag }}
            <input type="time" name="{{ form.end_time.name }}" id="{{ form.end_time.id_for_label }}"
                   value="{{ form.end_time.value|default_if_none:'' }}">
        </p>
        <p>{{ form.is_available.label_tag }} {{ form.is_available }}</p>
        <button type="submit" name="save_availability">Submit</button>

        {% if form.errors %}
            <ul style="color:red;">
                {% for field, errors in form.errors.items %}
                    {% for error in errors %}
                        <li><strong>{{ field|capfirst }}</strong>: {{ error }}</li>
                    {% endfor %}
                {% endfor %}
            </ul>
        {% endif %}
    </form>
{% endblock %}